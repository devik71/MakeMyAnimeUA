# üìã –ü—ñ–¥—Å—É–º–æ–∫ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Å—É–±—Ç–∏—Ç—Ä—ñ–≤

## üõ†Ô∏è –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏

### 1. `magi_pipeline/utils/external_subs.py`
**–û—Å–Ω–æ–≤–Ω–∏–π –º–æ–¥—É–ª—å –¥–ª—è –ø–æ—à—É–∫—É –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Å—É–±—Ç–∏—Ç—Ä—ñ–≤**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø–æ—à—É–∫ —Å—É–±—Ç–∏—Ç—Ä—ñ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è—Ö
- ‚úÖ –†–æ–∑—É–º–Ω–µ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –Ω–∞–∑–≤ —Ñ–∞–π–ª—ñ–≤
- ‚úÖ –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –º–æ–≤–∏ –∑–∞ –Ω–∞–∑–≤–æ—é
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ñ–æ—Ä–º–∞—Ç—ñ–≤: SRT, ASS, SSA, VTT, SUB, SBV
- ‚úÖ –ü—Ä–µ–≤ º—é —Å—É–±—Ç–∏—Ç—Ä—ñ–≤ –¥–ª—è –≤—Å—ñ—Ö —Ñ–æ—Ä–º–∞—Ç—ñ–≤

### 2. `magi_pipeline/utils/srt_parser.py`
**–ü–∞—Ä—Å–µ—Ä SRT —Å—É–±—Ç–∏—Ç—Ä—ñ–≤**
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è SRT ‚Üí JSON
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è JSON ‚Üí SRT
- ‚úÖ –û–±—Ä–æ–±–∫–∞ —Ä—ñ–∑–Ω–∏—Ö –∫–æ–¥—É–≤–∞–Ω—å (UTF-8, CP1251, Latin1)
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ HTML —Ç–µ–≥—ñ–≤ –≤ SRT

### 3. `magi_pipeline/utils/vtt_parser.py`
**–ü–∞—Ä—Å–µ—Ä VTT —Å—É–±—Ç–∏—Ç—Ä—ñ–≤**
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è VTT ‚Üí JSON
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è JSON ‚Üí VTT  
- ‚úÖ –û–±—Ä–æ–±–∫–∞ WebVTT —Ç–µ–≥—ñ–≤
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ WEBVTT –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤

### 4. `scripts/run_pipeline.py` (–º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π)
**–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –≤ –æ—Å–Ω–æ–≤–Ω–∏–π –ø–∞–π–ø–ª–∞–π–Ω**
- ‚úÖ –ü–æ—à—É–∫ —É –º–Ω–æ–∂–∏–Ω–Ω–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è—Ö
- ‚úÖ –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –≤–∏–±—ñ—Ä —Å—É–±—Ç–∏—Ç—Ä—ñ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –≤–∏–±—ñ—Ä –ø—Ä–∏ –æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—ñ
- ‚úÖ –ó–≤–æ—Ä–æ—Ç–Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ –≤–±—É–¥–æ–≤–∞–Ω–∏–º–∏ —Å—É–±—Ç–∏—Ç—Ä–∞–º–∏

### 5. `EXTERNAL_SUBTITLES.md`
**–ü–æ–≤–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ**
- ‚úÖ –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- ‚úÖ –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
- ‚úÖ –ü–æ—è—Å–Ω–µ–Ω–Ω—è –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤
- ‚úÖ –í–∏—Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º

## üîß –û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

### `find_external_subtitles(video_file, search_dirs)`
- –®—É–∫–∞—î –∑–æ–≤–Ω—ñ—à–Ω—ñ —Å—É–±—Ç–∏—Ç—Ä–∏ –¥–ª—è –≤—ñ–¥–µ–æ—Ñ–∞–π–ª—É
- –ü–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ –∑ –º–µ—Ç–∞–¥–∞–Ω–∏–º–∏ —Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–º –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ

### `get_subtitle_preview(subtitle_file, max_lines)`
- –ì–µ–Ω–µ—Ä—É—î –ø—Ä–µ–≤ º—é —Å—É–±—Ç–∏—Ç—Ä—ñ–≤ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –ü—ñ–¥—Ç—Ä–∏–º—É—î –≤—Å—ñ —Ñ–æ—Ä–º–∞—Ç–∏ —Å—É–±—Ç–∏—Ç—Ä—ñ–≤

### `clean_filename(filename)`
- –û—á–∏—â–∞—î –Ω–∞–∑–≤–∏ —Ñ–∞–π–ª—ñ–≤ –≤—ñ–¥ —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö —Ç–µ–≥—ñ–≤
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑—É—î –Ω–∞–∑–≤–∏ –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

### `extract_language_from_filename(filename)`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î –º–æ–≤—É —Å—É–±—Ç–∏—Ç—Ä—ñ–≤
- –ü—ñ–¥—Ç—Ä–∏–º—É—î 10+ –º–æ–≤

### `calculate_match_score(video_name, subtitle_name)`
- –†–æ–∑—Ä–∞—Ö–æ–≤—É—î —Ä–µ–π—Ç–∏–Ω–≥ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ (0-100%)
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫—ñ–ª—å–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

## üéØ –ù–æ–≤–∞ –ª–æ–≥—ñ–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω—É

```
1. –ü–æ—à—É–∫ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —Å—É–±—Ç–∏—Ç—Ä—ñ–≤
   ‚îú‚îÄ‚îÄ input/ (–æ—Å–Ω–æ–≤–Ω–∞ –ø–∞–ø–∫–∞)
   ‚îú‚îÄ‚îÄ input/Subs/ (–ø—ñ–¥–ø–∞–ø–∫–∏)
   ‚îú‚îÄ‚îÄ input/Subtitles/
   ‚îî‚îÄ‚îÄ <–¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è –≤—ñ–¥–µ–æ—Ñ–∞–π–ª—É>/

2. –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ:
   ‚îú‚îÄ‚îÄ –ü–æ–∫–∞–∑–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –∑ –ø—Ä–µ–≤ º—é
   ‚îú‚îÄ‚îÄ –ó–∞–ø–∏—Ç–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
   ‚îî‚îÄ‚îÄ –ü–∞—Ä—Å–∏—Ç–∏ –≤–∏–±—Ä–∞–Ω–∏–π —Ñ–∞–π–ª

3. –Ø–∫—â–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∞–±–æ –≤—ñ–¥—Ö–∏–ª–µ–Ω–æ:
   ‚îú‚îÄ‚îÄ –ü–æ—à—É–∫ –≤–±—É–¥–æ–≤–∞–Ω–∏—Ö —Å—É–±—Ç–∏—Ç—Ä—ñ–≤
   ‚îî‚îÄ‚îÄ –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü—ñ—è –∞—É–¥—ñ–æ

4. –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –ø–∞–π–ø–ª–∞–π–Ω...
```

## üöÄ –ü–µ—Ä–µ–≤–∞–≥–∏

- **–ì–Ω—É—á–∫—ñ—Å—Ç—å**: –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ä—ñ–∑–Ω–∏—Ö —Ñ–æ—Ä–º–∞—Ç—ñ–≤
- **–†–æ–∑—É–º–Ω—ñ—Å—Ç—å**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤
- **–ó—Ä—É—á–Ω—ñ—Å—Ç—å**: –ü—Ä–µ–≤ º—é —Ç–∞ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –≤–∏–±—ñ—Ä
- **–ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å**: –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ –∫–æ–¥—É–≤–∞–Ω–Ω—è
- **–ó–≤–æ—Ä–æ—Ç–Ω–∞ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å**: –°—Ç–∞—Ä–∞ –ª–æ–≥—ñ–∫–∞ –ø—Ä–∞—Ü—é—î —è–∫ —Ä–∞–Ω—ñ—à–µ

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ó–∞–ø—É—Å—Ç—ñ—Ç—å:
```bash
python3 scripts/run_pipeline.py
```

–î–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø–æ–∫–ª–∞–¥—ñ—Ç—å —É `input/`:
- –í—ñ–¥–µ–æ—Ñ–∞–π–ª (`movie.mkv`)
- –§–∞–π–ª —Å—É–±—Ç–∏—Ç—Ä—ñ–≤ (`movie.uk.srt`)

–ü—Ä–æ–≥—Ä–∞–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–Ω–∞–π–¥–µ —Ç–∞ –∑–∞–ø—Ä–æ–ø–æ–Ω—É—î —Å—É–±—Ç–∏—Ç—Ä–∏!

---

**‚úÖ –ì–æ—Ç–æ–≤–æ**: –ü—Ä–æ–≥—Ä–∞–º–∞ —Ç–µ–ø–µ—Ä –ø–æ–≤–Ω—ñ—Å—Ç—é –ø—ñ–¥—Ç—Ä–∏–º—É—î –∑–æ–≤–Ω—ñ—à–Ω—ñ —Å—É–±—Ç–∏—Ç—Ä–∏ –∑ —Ä–æ–∑—É–º–Ω–∏–º –ø–æ—à—É–∫–æ–º —Ç–∞ –∑—Ä—É—á–Ω–∏–º —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º!